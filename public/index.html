<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <title>ğŸ  MÅyu Club æ¸¬è©¦èŠå¤©å®¤</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
      body {
        font-family: "Microsoft JhengHei", sans-serif;
        background: linear-gradient(to bottom, #f5f7fa, #e2ebf0);
        padding: 2em;
        text-align: center;
      }

      h2 {
        color: #2c3e50;
      }

      #status {
        background: #fff;
        border-radius: 8px;
        padding: 10px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        display: inline-block;
        margin-bottom: 1em;
      }

      #chat {
        width: 90%;
        max-width: 500px;
        height: 250px;
        margin: 0 auto;
        border: 1px solid #ccc;
        border-radius: 8px;
        padding: 10px;
        overflow-y: auto;
        background: #fff;
        text-align: left;
      }

      input {
        padding: 8px;
        width: 70%;
        border-radius: 6px;
        border: 1px solid #ccc;
        margin-top: 1em;
      }

      button {
        padding: 8px 15px;
        border: none;
        background: #3a8ef6;
        color: #fff;
        border-radius: 6px;
        cursor: pointer;
      }

      button:hover {
        background: #3279d3;
      }
    </style>
  </head>

  <body>
    <h2>ğŸŸ æ­¡è¿ä¾†åˆ° MÅyu Club</h2>
    <p id="status">é€£ç·šä¸­...</p>

    <div id="chat"></div>

    <div>
      <input id="msg" placeholder="è¼¸å…¥è¨Šæ¯..." />
      <button onclick="sendMsg()">é€å‡º</button>
    </div>

    <script>
      // èˆ‡ä¼ºæœå™¨å»ºç«‹é€£ç·š
      const socket = io();

      // åˆæ¬¡é€£ç·šæˆåŠŸ
      socket.on("connect", () => {
        console.log("âœ… å·²é€£ç·šï¼ŒSocket ID:", socket.id);
        document.getElementById("status").innerText = "å·²é€£ç·šï¼Œç­‰å¾…é…å°ä¸­...";
      });

      // ç‹€æ…‹æ›´æ–°ï¼ˆä¼ºæœå™¨ç«¯çš„æç¤ºï¼Œä¾‹å¦‚ç­‰å¾…ä¸­ï¼‰
      socket.on("status", (text) => {
        console.log("ğŸ“¡ ç‹€æ…‹äº‹ä»¶ï¼š", text);
        document.getElementById("status").innerText = text;
      });

      // é…å°æˆåŠŸäº‹ä»¶
      socket.on("match", (text) => {
        console.log("ğŸ§© æ”¶åˆ° match äº‹ä»¶ï¼š", text);
        document.getElementById("status").innerText = text;
        appendSystemMessage("ğŸ’¬ ä½ å¯ä»¥é–‹å§‹èŠå¤©å›‰ï¼");
      });

      // æ¥æ”¶èŠå¤©è¨Šæ¯
      socket.on("chat", (msg) => {
        appendMessage(msg);
      });

      // é›¢ç·šäº‹ä»¶
      socket.on("disconnect", () => {
        console.log("ğŸ”´ é›¢ç·š");
        appendSystemMessage("âš ï¸ ä¼ºæœå™¨ä¸­æ–·ï¼Œè«‹é‡æ–°æ•´ç†ã€‚");
      });

      // é€å‡ºèŠå¤©è¨Šæ¯
      function sendMsg() {
        const msg = document.getElementById("msg").value.trim();
        if (!msg) return;
        socket.emit("chat", msg);
        document.getElementById("msg").value = "";
      }

      // é¡¯ç¤ºè¨Šæ¯
      function appendMessage(msg) {
        const div = document.createElement("div");
        div.textContent = msg;
        document.getElementById("chat").appendChild(div);
      }

      // é¡¯ç¤ºç³»çµ±è¨Šæ¯ï¼ˆç°å­—ï¼‰
      function appendSystemMessage(msg) {
        const div = document.createElement("div");
        div.style.color = "#888";
        div.textContent = msg;
        document.getElementById("chat").appendChild(div);
      }
    </script>
  </body>
</html>
